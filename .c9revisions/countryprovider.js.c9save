{"ts":1347908510136,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var countryCounter = 1;\r\n\r\nCountryProvider = function(){};\r\nCountryProvider.prototype.dummyData = [];\r\n\r\nCountryProvider.prototype.findAll = function(callback) {\r\n  callback( null, this.dummyData )\r\n};\r\n\r\nCountryProvider.prototype.findById = function(id, callback) {\r\n  var result = null;\r\n  for(var i =0;i<this.dummyData.length;i++) {\r\n    if( this.dummyData[i]._id == id ) {\r\n      result = this.dummyData[i];\r\n      break;\r\n    }\r\n  }\r\n  callback(null, result);\r\n};\r\n\r\nCountryProvider.prototype.updateById = function(id, newCountryName, callback) {\r\n  var result = null;\r\n  for(var i =0;i<this.dummyData.length;i++) {\r\n    if( this.dummyData[i]._id == id ) {\r\n      result = this.dummyData[i];\r\n      break;\r\n    }\r\n  }\r\n  result.country = newCountryName;\r\n  result.updateStatus = \"Updated!\";\r\n  callback(null, result);\r\n};\r\n\r\nCountryProvider.prototype.save = function(countries, callback) {\r\n  var country = null;\r\n\r\n  if( typeof(countries.length)==\"undefined\")\r\n    countries = [countries];\r\n\r\n  for( var i =0;i< countries.length;i++ ) {\r\n    country = countries[i];\r\n    country._id = countryCounter++;\r\n    country.created_at = new Date();\r\n\r\n    if( country.comments === undefined )\r\n      country.comments = [];\r\n\r\n    for(var j =0;j< country.comments.length; j++) {\r\n      country.comments[j].created_at = new Date();\r\n    }\r\n    this.dummyData[this.dummyData.length]= country;\r\n  }\r\n  callback(null, countries);\r\n};\r\n\r\n/* Lets bootstrap with dummy data */\r\nnew CountryProvider().save([\r\n  {country: 'Norway', updateStatus: '', text: 'This is a country with mountains and fjords', comments:[{author:'Bob', comment:'I love it'}, {author:'Dave', comment:'This is rubbish!'}]},\r\n  {country: 'USA', updateStatus: '', text: 'This country consists of states and people', comments:[{author:'Bree', comment:'I get it'}, {author:'Doyle', comment:'That is true'}]},\r\n  {country: 'Kenya', updateStatus: '', text: 'African country'},\r\n  {country: 'Russia', updateStatus: '', text: 'Moscow is the current capital'},\r\n  {country: 'Canada', updateStatus: '', text: 'Famous for the maple leaf'},\r\n  {country: 'UK', updateStatus: '', text: 'Flag is called Union Jack', comments:[{author:'Bill', comment:'It is called General Union also'}, {author:'Dave', comment:'This is rubbish!'}]}\r\n], function(error, countries){});\r\n\r\nexports.CountryProvider = CountryProvider;"]],"start1":0,"start2":0,"length1":0,"length2":2358}]],"length":2358}
